# API í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

## ğŸ“‹ ìƒì„±ëœ í…ŒìŠ¤íŠ¸ íŒŒì¼

### 1. `test_all_apis.py` - ì „ì²´ API í†µí•© í…ŒìŠ¤íŠ¸

ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ê°€ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í†µí•© í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.

#### í…ŒìŠ¤íŠ¸ í•­ëª©
- âœ… ì„œë²„ ìƒíƒœ í™•ì¸ (`GET /`)
- âœ… ì˜ˆì¸¡ API (`GET /api/predictions`, `GET /api/predictions/by-date`)
- âœ… ë‰´ìŠ¤ API (`GET /api/newsdb`)
- âœ… ì‹œì¥ ì§€í‘œ API (`GET /api/market-metrics`)
- âœ… ì‹œë®¬ë ˆì´ì…˜ API (`POST /api/simulate`)
- âœ… API ë¬¸ì„œ (`GET /docs`, `GET /redoc`)

#### ì‹¤í–‰ ë°©ë²•

**ë¡œì»¬ ì„œë²„ í…ŒìŠ¤íŠ¸:**
```bash
# 1. ì„œë²„ ì‹¤í–‰ (ë³„ë„ í„°ë¯¸ë„)
uvicorn main:app --reload

# 2. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python tests/test_all_apis.py
```

**EC2 ì„œë²„ í…ŒìŠ¤íŠ¸:**
```bash
python tests/test_all_apis.py --base-url http://44.252.76.158:8000
```

#### ì˜ˆìƒ ì¶œë ¥

```
ğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ª
  API í†µí•© í…ŒìŠ¤íŠ¸ ì‹œì‘
  ì„œë²„: http://localhost:8000
ğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ªğŸ§ª

================================================================================
  1ï¸âƒ£  ì„œë²„ ìƒíƒœ í™•ì¸
================================================================================
âœ… PASS | GET /
       â””â”€ ì‘ë‹µ: Server is running with new structure! ğŸš€

================================================================================
  2ï¸âƒ£  ì˜ˆì¸¡ API (Predictions)
================================================================================
âœ… PASS | GET /api/predictions?commodity=corn
       â””â”€ ì˜ˆì¸¡ 90ê±´, ê³¼ê±°ê°€ê²© 30ê±´
âœ… PASS | GET /api/predictions/by-date
       â””â”€ ë‚ ì§œ: 2026-02-06

...

================================================================================
  ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½
================================================================================

ì´ í…ŒìŠ¤íŠ¸: 8ê°œ
âœ… í†µê³¼: 8ê°œ
âŒ ì‹¤íŒ¨: 0ê°œ
í†µê³¼ìœ¨: 100.0%

================================================================================
âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!
================================================================================
```

---

### 2. `test_s3_model_loading.py` - S3 ëª¨ë¸ ë¡œë”© í…ŒìŠ¤íŠ¸

S3ì—ì„œ ëª¨ë¸ì„ ë‹¤ìš´ë¡œë“œí•˜ê³  ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ëŠ” í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤.

#### ì‹¤í–‰ ë°©ë²•

```bash
# í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í•„ìš”
export MODEL_LOAD_MODE=s3
export AWS_ACCESS_KEY_ID=your_key
export AWS_SECRET_ACCESS_KEY=your_secret

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python tests/test_s3_model_loading.py
```

---

## ğŸš€ ì„œë²„ ì‹¤í–‰ ë°©ë²•

### ë¡œì»¬ ê°œë°œ ì„œë²„

```bash
# ê°€ìƒí™˜ê²½ í™œì„±í™”
source backend_venv/bin/activate  # Linux/Mac
# ë˜ëŠ”
backend_venv\Scripts\activate  # Windows

# ì„œë²„ ì‹¤í–‰
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

### EC2 í”„ë¡œë•ì…˜ ì„œë²„

```bash
# SSH ì ‘ì†
ssh ubuntu@44.252.76.158

# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /home/ubuntu/pro-nlp-finalproject-backend-nlp-10

# ìµœì‹  ì½”ë“œ pull
git pull origin main

# ê°€ìƒí™˜ê²½ í™œì„±í™”
source backend_venv/bin/activate

# ì„œë²„ ì¬ì‹œì‘ (systemd ì‚¬ìš© ì‹œ)
sudo systemctl restart backend-api

# ë˜ëŠ” ì§ì ‘ ì‹¤í–‰
uvicorn main:app --host 0.0.0.0 --port 8000
```

---

## ğŸ” ë¬¸ì œ í•´ê²°

### Connection Refused ì—ëŸ¬

```
Error: Failed to establish a new connection: [Errno 61] Connection refused
```

**ì›ì¸:** ì„œë²„ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

**í•´ê²°:**
1. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
2. í¬íŠ¸ê°€ ì˜¬ë°”ë¥¸ì§€ í™•ì¸ (ê¸°ë³¸ 8000)
3. ë°©í™”ë²½ ì„¤ì • í™•ì¸ (EC2 Security Group)

### ValidationError

```
pydantic_core._pydantic_core.ValidationError
```

**ì›ì¸:** DB ë°ì´í„°ì™€ ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜

**í•´ê²°:**
1. ìµœì‹  ì½”ë“œë¡œ ì—…ë°ì´íŠ¸ (`git pull`)
2. ì„œë²„ ì¬ì‹œì‘
3. DB ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš” ì‹œ ì‹¤í–‰

---

## ğŸ“ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì„œë²„ ë°°í¬ í›„ ë‹¤ìŒ í•­ëª©ë“¤ì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] ì„œë²„ ìƒíƒœ í™•ì¸ (`GET /`)
- [ ] Swagger UI ì ‘ê·¼ (`GET /docs`)
- [ ] ì˜ˆì¸¡ API ì¡°íšŒ (`GET /api/predictions?commodity=corn`)
- [ ] ë‰´ìŠ¤ API ì¡°íšŒ (`GET /api/newsdb?limit=5`)
- [ ] ì‹œë®¬ë ˆì´ì…˜ API (`POST /api/simulate`)
- [ ] S3 ëª¨ë¸ ë¡œë”© (S3 ëª¨ë“œì¸ ê²½ìš°)
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í™•ì¸
- [ ] DB ì—°ê²° í™•ì¸

